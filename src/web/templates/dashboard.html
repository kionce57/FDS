{% extends "base.html" %}

{% block title %}å„€è¡¨æ¿ - FDS Dashboard{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ“Š ç³»çµ±å„€è¡¨æ¿</h1>
    <p class="subtitle">Fall Detection System ç›£æ§ä¸­å¿ƒ</p>
</div>

<!-- ç³»çµ±ç‹€æ…‹ -->
<section class="section">
    <h2 class="section-title">ç³»çµ±ç‹€æ…‹</h2>
    <div class="status-cards">
        <div class="card status-card {% if db_connected %}status-online{% else %}status-offline{% endif %}">
            <div class="card-icon">{% if db_connected %}ğŸŸ¢{% else %}ğŸ”´{% endif %}</div>
            <div class="card-content">
                <h3>è³‡æ–™åº«ç‹€æ…‹</h3>
                <p class="status-text">{% if db_connected %}å·²é€£ç·š{% else %}æœªé€£ç·š{% endif %}</p>
            </div>
        </div>
        <div class="card status-card status-online">
            <div class="card-icon">ğŸŒ</div>
            <div class="card-content">
                <h3>Web Server</h3>
                <p class="status-text">é‹è¡Œä¸­</p>
            </div>
        </div>
    </div>
</section>

<!-- çµ±è¨ˆè³‡è¨Š -->
{% if stats %}
<section class="section">
    <h2 class="section-title">äº‹ä»¶çµ±è¨ˆ</h2>
    <div class="stats-grid">
        <div class="card stat-card">
            <div class="stat-value">{{ stats.total_events }}</div>
            <div class="stat-label">ç¸½äº‹ä»¶æ•¸</div>
        </div>
        <div class="card stat-card">
            <div class="stat-value">{{ stats.today_events }}</div>
            <div class="stat-label">ä»Šæ—¥äº‹ä»¶</div>
        </div>
        <div class="card stat-card">
            <div class="stat-value">{{ stats.this_week_events }}</div>
            <div class="stat-label">æœ¬é€±äº‹ä»¶</div>
        </div>
        <div class="card stat-card">
            <div class="stat-value">{{ "%.1f"|format(stats.total_clips_size_mb) }} MB</div>
            <div class="stat-label">å½±ç‰‡ç¸½å¤§å°</div>
        </div>
    </div>
</section>
{% endif %}

<!-- æœ€è¿‘äº‹ä»¶ -->
<section class="section">
    <div class="section-header">
        <h2 class="section-title">æœ€è¿‘äº‹ä»¶</h2>
        <a href="/events" class="btn btn-secondary">æŸ¥çœ‹å…¨éƒ¨</a>
    </div>
    
    {% if recent_events %}
    <div class="events-list">
        {% for event in recent_events %}
        <div class="card event-card">
            <div class="event-info">
                <div class="event-id">{{ event.event_id }}</div>
                <div class="event-time">{{ event.created_at_local }}</div>
            </div>
            <div class="event-status">
                {% if event.has_clip %}
                <span class="badge badge-success">æœ‰å½±ç‰‡</span>
                {% else %}
                <span class="badge badge-secondary">ç„¡å½±ç‰‡</span>
                {% endif %}
            </div>
            <div class="event-actions">
                <a href="/events/{{ event.event_id }}" class="btn btn-primary btn-sm">æŸ¥çœ‹è©³æƒ…</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">ğŸ“­</div>
        <p>å°šç„¡äº‹ä»¶è¨˜éŒ„</p>
        {% if not db_connected %}
        <p class="text-muted">è³‡æ–™åº«æœªé€£ç·šæˆ–ä¸å­˜åœ¨</p>
        {% endif %}
    </div>
    {% endif %}
</section>
{% endblock %}
